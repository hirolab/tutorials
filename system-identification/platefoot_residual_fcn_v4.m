function res = platefoot_residual_fcn_v4(in1,in2,mp,in4,in5,in6,mf,in8,in9,in10,in11,in12,in13,in14,in15,in16,in17,in18,in19,in20,in21,in22,in23,in24,in25,in26,in27,in28,in29,in30,in31,in32,in33)
%PLATEFOOT_RESIDUAL_FCN_V4
%    RES = PLATEFOOT_RESIDUAL_FCN_V4(IN1,IN2,MP,IN4,IN5,IN6,MF,IN8,IN9,IN10,IN11,IN12,IN13,IN14,IN15,IN16,IN17,IN18,IN19,IN20,IN21,IN22,IN23,IN24,IN25,IN26,IN27,IN28,IN29,IN30,IN31,IN32,IN33)

%    This function was generated by the Symbolic Math Toolbox version 8.3.
%    23-Jul-2020 10:30:44

Bc1 = in13(:,1);
Bc2 = in13(:,2);
Bc3 = in13(:,3);
Bd1 = in12(:,1);
Bd2 = in12(:,2);
Bd3 = in12(:,3);
Jf1 = in5(:,1);
Jf2 = in5(:,2);
Jf3 = in5(:,3);
Jp1 = in1(:,1);
Jp2 = in1(:,2);
Jp3 = in1(:,3);
Kc1 = in11(:,1);
Kc2 = in11(:,2);
Kc3 = in11(:,3);
Kd1 = in10(:,1);
Kd2 = in10(:,2);
Kd3 = in10(:,3);
Pf1 = in6(:,1);
Pf2 = in6(:,2);
Pf3 = in6(:,3);
Pp1 = in2(:,1);
Pp2 = in2(:,2);
Pp3 = in2(:,3);
af1 = in30(1,:);
af2 = in30(2,:);
af3 = in30(3,:);
ap1 = in24(1,:);
ap2 = in24(2,:);
ap3 = in24(3,:);
atorque1 = in33(1,:);
atorque2 = in33(2,:);
atorque3 = in33(3,:);
fang1 = in25(1,:);
fang2 = in25(2,:);
fang3 = in25(3,:);
fquat01 = in15(:,1);
fquat02 = in15(:,2);
fquat03 = in15(:,3);
fquat04 = in15(:,4);
ftrans1 = in28(1,:);
ftrans2 = in28(2,:);
ftrans3 = in28(3,:);
g1 = in9(1,:);
g2 = in9(2,:);
g3 = in9(3,:);
pang1 = in19(1,:);
pang2 = in19(2,:);
pang3 = in19(3,:);
pforce1 = in18(1,:);
pforce2 = in18(2,:);
pforce3 = in18(3,:);
pquat01 = in14(:,1);
pquat02 = in14(:,2);
pquat03 = in14(:,3);
pquat04 = in14(:,4);
ptorque1 = in17(1,:);
ptorque2 = in17(2,:);
ptorque3 = in17(3,:);
ptrans1 = in22(1,:);
ptrans2 = in22(2,:);
ptrans3 = in22(3,:);
rf1 = in8(1,:);
rf2 = in8(2,:);
rf3 = in8(3,:);
rp1 = in4(1,:);
rp2 = in4(2,:);
rp3 = in4(3,:);
sang1 = in31(1,:);
sang2 = in31(2,:);
sang3 = in31(3,:);
squat01 = in16(:,1);
squat02 = in16(:,2);
squat03 = in16(:,3);
squat04 = in16(:,4);
vf1 = in29(1,:);
vf2 = in29(2,:);
vf3 = in29(3,:);
vp1 = in23(1,:);
vp2 = in23(2,:);
vp3 = in23(3,:);
wdf1 = in27(1,:);
wdf2 = in27(2,:);
wdf3 = in27(3,:);
wdp1 = in21(1,:);
wdp2 = in21(2,:);
wdp3 = in21(3,:);
wf1 = in26(1,:);
wf2 = in26(2,:);
wf3 = in26(3,:);
wp1 = in20(1,:);
wp2 = in20(2,:);
wp3 = in20(3,:);
ws1 = in32(1,:);
ws2 = in32(2,:);
ws3 = in32(3,:);
res = [ptorque1.*(((pang2.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang1.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pang3.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat03.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).^2.*2.0)./(pang1.^2+pang2.^2+pang3.^2)+((-pang1.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang2.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat04.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).^2.*2.0)./(pang1.^2+pang2.^2+pang3.^2)-1.0)+(((pang1.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pang2.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat02.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*(-pang1.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang2.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat04.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*2.0)./(pang1.^2+pang2.^2+pang3.^2)-((pang1.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang2.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pquat01.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*(pang2.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang1.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pang3.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat03.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*2.0)./(pang1.^2+pang2.^2+pang3.^2)).*(Jp3.*wdp3+Pp1.*wdp2+Pp2.*wdp1+wp1.*(Jp2.*wp2+Pp1.*wp3+Pp3.*wp1)-wp2.*(Jp1.*wp1+Pp2.*wp3+Pp3.*wp2))+(((pang1.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pang2.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat02.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*(pang2.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang1.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pang3.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat03.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*2.0)./(pang1.^2+pang2.^2+pang3.^2)+((pang1.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang2.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pquat01.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*(-pang1.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang2.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat04.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*2.0)./(pang1.^2+pang2.^2+pang3.^2)).*(Jp2.*wdp2+Pp1.*wdp3+Pp3.*wdp1-wp1.*(Jp3.*wp3+Pp1.*wp2+Pp2.*wp1)+wp3.*(Jp1.*wp1+Pp2.*wp3+Pp3.*wp2))+(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(atorque2+Bc3.*(wf1-ws1.*((((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)-((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)-((squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2))+(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2))+(((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)-1.0).*(((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)-1.0))+ws2.*((((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)-((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2))+(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)-((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)-1.0)+(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)).*(((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)-1.0))+ws3.*(-(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)-((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2))+(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)-1.0)+(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)-((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)).*(((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)-1.0)))+Bc1.*(wf3+ws1.*(-(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)-((squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2))+(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)-((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)-1.0)+(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)).*(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)-1.0))-ws2.*((((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)-((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2))-(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)-1.0)+(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)-((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)).*(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)-1.0))-ws3.*((((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2))+(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)-((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)-((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2))+(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)-1.0).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)-1.0)))+Bd2.*(wf2+ws1.*((((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)-((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2))+(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)-1.0)+(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)-((squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)).*(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)-1.0))-ws2.*((((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)-((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)-((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2))+(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2))+(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)-1.0).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)-1.0))-ws3.*((((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)-((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2))+(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)-((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)-1.0)-(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)).*(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)-1.0)))+Kc1.*acos(((((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)-((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)-((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)))./2.0+((((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)))./2.0+((((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)-((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)-((squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)))./2.0+((((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)))./2.0+((((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)-((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)-((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)))./2.0+((((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)))./2.0+((((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)-1.0).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)-1.0))./2.0+((((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)-1.0).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)-1.0))./2.0+((((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)-1.0).*(((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)-1.0))./2.0-1.0./2.0).*((((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)-((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2))-(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)-((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2))-(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)-((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)-1.0)+(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)-1.0)+(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)-((squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)).*(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)-1.0)-(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)).*(((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)-1.0))+Kc3.*acos(((((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)-((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)-((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)))./2.0+((((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)))./2.0+((((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)-((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)-((squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)))./2.0+((((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)))./2.0+((((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)-((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)-((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)))./2.0+((((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)))./2.0+((((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)-1.0).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)-1.0))./2.0+((((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)-1.0).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)-1.0))./2.0+((((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)-1.0).*(((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)-1.0))./2.0-1.0./2.0).*((((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)-((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2))-(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)-((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2))+(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)-((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)-1.0)+(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)-1.0)-(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)-((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)).*(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)-1.0)-(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)).*(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)-1.0))+Kd2.*acos(((((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)-((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)-((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)))./2.0+((((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)))./2.0+((((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)-((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)-((squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)))./2.0+((((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)))./2.0+((((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)-((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)-((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)))./2.0+((((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)))./2.0+((((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)-1.0).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)-1.0))./2.0+((((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)-1.0).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)-1.0))./2.0+((((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)-1.0).*(((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)-1.0))./2.0-1.0./2.0).*((((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)-((squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2))-(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)-((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2))-(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)-((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)-1.0)+(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)-1.0)+(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)-((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)).*(((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)-1.0)-(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)).*(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)-1.0)))+(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)-((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(atorque3+Bc2.*(wf1-ws1.*((((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)-((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)-((squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2))+(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2))+(((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)-1.0).*(((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)-1.0))+ws2.*((((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)-((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2))+(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)-((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)-1.0)+(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)).*(((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)-1.0))+ws3.*(-(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)-((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2))+(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)-1.0)+(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)-((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)).*(((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)-1.0)))+Bc1.*(wf2+ws1.*((((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)-((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2))+(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)-1.0)+(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)-((squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)).*(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)-1.0))-ws2.*((((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)-((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)-((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2))+(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2))+(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)-1.0).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)-1.0))-ws3.*((((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)-((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2))+(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)-((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)-1.0)-(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)).*(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)-1.0)))+Bd3.*(wf3+ws1.*(-(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)-((squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2))+(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)-((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)-1.0)+(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)).*(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)-1.0))-ws2.*((((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)-((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2))-(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)-1.0)+(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)-((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)).*(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)-1.0))-ws3.*((((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2))+(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)-((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)-((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2))+(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)-1.0).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)-1.0)))+Kc1.*acos(((((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)-((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)-((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)))./2.0+((((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)))./2.0+((((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)-((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)-((squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)))./2.0+((((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)))./2.0+((((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)-((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)-((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)))./2.0+((((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)))./2.0+((((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)-1.0).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)-1.0))./2.0+((((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)-1.0).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)-1.0))./2.0+((((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)-1.0).*(((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)-1.0))./2.0-1.0./2.0).*((((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)-((squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2))-(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)-((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2))-(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)-((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)-1.0)+(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)-1.0)+(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)-((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)).*(((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)-1.0)-(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)).*(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)-1.0))+Kc2.*acos(((((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)-((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)-((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)))./2.0+((((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)))./2.0+((((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)-((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)-((squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)))./2.0+((((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)))./2.0+((((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)-((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)-((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)))./2.0+((((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)))./2.0+((((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)-1.0).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)-1.0))./2.0+((((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)-1.0).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)-1.0))./2.0+((((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)-1.0).*(((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)-1.0))./2.0-1.0./2.0).*((((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)-((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2))-(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)-((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2))+(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)-((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)-1.0)+(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)-1.0)-(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)-((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)).*(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)-1.0)-(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)).*(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)-1.0))+Kd3.*acos(((((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)-((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)-((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)))./2.0+((((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)))./2.0+((((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)-((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)-((squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)))./2.0+((((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)))./2.0+((((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)-((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)-((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)))./2.0+((((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)))./2.0+((((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)-1.0).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)-1.0))./2.0+((((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)-1.0).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)-1.0))./2.0+((((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)-1.0).*(((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)-1.0))./2.0-1.0./2.0).*((((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)-((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2))-(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)-((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2))-(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)-((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)-1.0)+(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)-1.0)+(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)-((squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)).*(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)-1.0)-(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)).*(((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)-1.0)))-(ftrans2-ptrans2).*(-(pforce1-g1.*mp).*(((pang1.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pang2.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat02.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*(-pang1.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang2.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat04.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*2.0)./(pang1.^2+pang2.^2+pang3.^2)+((pang1.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang2.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pquat01.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*(pang2.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang1.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pang3.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat03.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*2.0)./(pang1.^2+pang2.^2+pang3.^2))+(pforce2-g2.*mp).*(((pang1.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pang2.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat02.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*(pang1.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang2.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pquat01.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*2.0)./(pang1.^2+pang2.^2+pang3.^2)-((pang2.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang1.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pang3.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat03.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*(-pang1.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang2.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat04.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*2.0)./(pang1.^2+pang2.^2+pang3.^2))+(pforce3-g3.*mp).*(((pang1.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pang2.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat02.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).^2.*2.0)./(pang1.^2+pang2.^2+pang3.^2)+((pang2.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang1.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pang3.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat03.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).^2.*2.0)./(pang1.^2+pang2.^2+pang3.^2)-1.0))-(ftrans3-ptrans3).*((pforce1-g1.*mp).*(((pang1.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pang2.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat02.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*(pang2.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang1.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pang3.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat03.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*2.0)./(pang1.^2+pang2.^2+pang3.^2)-((pang1.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang2.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pquat01.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*(-pang1.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang2.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat04.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*2.0)./(pang1.^2+pang2.^2+pang3.^2))+(pforce3-g3.*mp).*(((pang1.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pang2.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat02.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*(pang1.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang2.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pquat01.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*2.0)./(pang1.^2+pang2.^2+pang3.^2)+((pang2.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang1.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pang3.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat03.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*(-pang1.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang2.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat04.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*2.0)./(pang1.^2+pang2.^2+pang3.^2))-(pforce2-g2.*mp).*(((pang1.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pang2.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat02.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).^2.*2.0)./(pang1.^2+pang2.^2+pang3.^2)+((-pang1.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang2.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat04.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).^2.*2.0)./(pang1.^2+pang2.^2+pang3.^2)-1.0))+(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)-((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(Jf3.*wdf3+Pf1.*wdf2+Pf2.*wdf1+wf1.*(Jf2.*wf2+Pf1.*wf3+Pf3.*wf1)-wf2.*(Jf1.*wf1+Pf2.*wf3+Pf3.*wf2))+(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(Jf2.*wdf2+Pf1.*wdf3+Pf3.*wdf1-wf1.*(Jf3.*wf3+Pf1.*wf2+Pf2.*wf1)+wf3.*(Jf1.*wf1+Pf2.*wf3+Pf3.*wf2))-ptorque2.*(((pang1.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pang2.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat02.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*(pang2.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang1.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pang3.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat03.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*2.0)./(pang1.^2+pang2.^2+pang3.^2)+((pang1.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang2.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pquat01.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*(-pang1.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang2.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat04.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*2.0)./(pang1.^2+pang2.^2+pang3.^2))-ptorque3.*(((pang1.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pang2.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat02.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*(-pang1.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang2.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat04.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*2.0)./(pang1.^2+pang2.^2+pang3.^2)-((pang1.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang2.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pquat01.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*(pang2.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang1.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pang3.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat03.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*2.0)./(pang1.^2+pang2.^2+pang3.^2))+vf3.*(mf.*(-vf2+(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(rf1.*wf2-rf2.*wf1)+(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)-((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(rf2.*wf3-rf3.*wf2)+(rf1.*wf3-rf3.*wf1).*(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)-1.0))+mp.*(-vp2+(((pang1.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pang2.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat02.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*(pang1.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang2.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pquat01.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*2.0)./(pang1.^2+pang2.^2+pang3.^2)+((pang2.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang1.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pang3.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat03.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*(-pang1.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang2.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat04.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*2.0)./(pang1.^2+pang2.^2+pang3.^2)).*(rp1.*wp2-rp2.*wp1)+(((pang1.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pang2.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat02.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*(pang2.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang1.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pang3.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat03.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*2.0)./(pang1.^2+pang2.^2+pang3.^2)-((pang1.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang2.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pquat01.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*(-pang1.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang2.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat04.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*2.0)./(pang1.^2+pang2.^2+pang3.^2)).*(rp2.*wp3-rp3.*wp2)+(rp1.*wp3-rp3.*wp1).*(((pang1.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pang2.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat02.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).^2.*2.0)./(pang1.^2+pang2.^2+pang3.^2)+((-pang1.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang2.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat04.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).^2.*2.0)./(pang1.^2+pang2.^2+pang3.^2)-1.0)))-(((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)-1.0).*(atorque1+Bc3.*(wf2+ws1.*((((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)-((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2))+(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)-1.0)+(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)-((squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)).*(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)-1.0))-ws2.*((((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)-((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)-((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2))+(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2))+(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)-1.0).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)-1.0))-ws3.*((((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)-((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2))+(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)-((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)-1.0)-(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)).*(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)-1.0)))+Bc2.*(wf3+ws1.*(-(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)-((squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2))+(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)-((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)-1.0)+(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)).*(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)-1.0))-ws2.*((((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)-((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2))-(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)-1.0)+(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)-((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)).*(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)-1.0))-ws3.*((((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2))+(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)-((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)-((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2))+(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)-1.0).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)-1.0)))+Bd1.*(wf1-ws1.*((((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)-((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)-((squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2))+(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2))+(((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)-1.0).*(((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)-1.0))+ws2.*((((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)-((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2))+(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)-((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)-1.0)+(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)).*(((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)-1.0))+ws3.*(-(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)-((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2))+(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)-1.0)+(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)-((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)).*(((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)-1.0)))+Kc2.*acos(((((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)-((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)-((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)))./2.0+((((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)))./2.0+((((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)-((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)-((squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)))./2.0+((((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)))./2.0+((((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)-((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)-((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)))./2.0+((((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)))./2.0+((((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)-1.0).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)-1.0))./2.0+((((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)-1.0).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)-1.0))./2.0+((((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)-1.0).*(((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)-1.0))./2.0-1.0./2.0).*((((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)-((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2))-(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)-((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2))-(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)-((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)-1.0)+(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)-1.0)+(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)-((squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)).*(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)-1.0)-(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)).*(((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)-1.0))+Kc3.*acos(((((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)-((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)-((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)))./2.0+((((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)))./2.0+((((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)-((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)-((squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)))./2.0+((((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)))./2.0+((((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)-((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)-((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)))./2.0+((((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)))./2.0+((((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)-1.0).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)-1.0))./2.0+((((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)-1.0).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)-1.0))./2.0+((((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)-1.0).*(((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)-1.0))./2.0-1.0./2.0).*((((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)-((squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2))-(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)-((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2))-(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)-((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)-1.0)+(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)-1.0)+(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)-((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)).*(((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)-1.0)-(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)).*(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)-1.0))+Kd1.*acos(((((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)-((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)-((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)))./2.0+((((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)))./2.0+((((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)-((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)-((squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)))./2.0+((((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)))./2.0+((((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)-((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)-((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)))./2.0+((((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)))./2.0+((((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)-1.0).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)-1.0))./2.0+((((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)-1.0).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)-1.0))./2.0+((((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)-1.0).*(((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)-1.0))./2.0-1.0./2.0).*((((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)-((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2))-(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)-((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2))+(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)-((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)-1.0)+(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)-1.0)-(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)-((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)).*(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)-1.0)-(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)).*(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)-1.0)))-(((pang2.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang1.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pang3.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat03.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).^2.*2.0)./(pang1.^2+pang2.^2+pang3.^2)+((-pang1.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang2.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat04.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).^2.*2.0)./(pang1.^2+pang2.^2+pang3.^2)-1.0).*(Jp1.*wdp1+Pp2.*wdp3+Pp3.*wdp2+wp2.*(Jp3.*wp3+Pp1.*wp2+Pp2.*wp1)-wp3.*(Jp2.*wp2+Pp1.*wp3+Pp3.*wp1))-(((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)-1.0).*(Jf1.*wdf1+Pf2.*wdf3+Pf3.*wdf2+wf2.*(Jf3.*wf3+Pf1.*wf2+Pf2.*wf1)-wf3.*(Jf2.*wf2+Pf1.*wf3+Pf3.*wf1))+vf2.*(mf.*(vf3-(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)-((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(rf1.*wf3-rf3.*wf1)-(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(rf2.*wf3-rf3.*wf2)+(rf1.*wf2-rf2.*wf1).*(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)-1.0))+mp.*(vp3-(((pang1.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pang2.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat02.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*(pang1.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang2.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pquat01.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*2.0)./(pang1.^2+pang2.^2+pang3.^2)-((pang2.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang1.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pang3.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat03.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*(-pang1.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang2.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat04.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*2.0)./(pang1.^2+pang2.^2+pang3.^2)).*(rp1.*wp3-rp3.*wp1)-(((pang1.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pang2.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat02.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*(-pang1.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang2.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat04.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*2.0)./(pang1.^2+pang2.^2+pang3.^2)+((pang1.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang2.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pquat01.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*(pang2.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang1.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pang3.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat03.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*2.0)./(pang1.^2+pang2.^2+pang3.^2)).*(rp2.*wp3-rp3.*wp2)+(rp1.*wp2-rp2.*wp1).*(((pang1.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pang2.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat02.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).^2.*2.0)./(pang1.^2+pang2.^2+pang3.^2)+((pang2.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang1.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pang3.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat03.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).^2.*2.0)./(pang1.^2+pang2.^2+pang3.^2)-1.0)))-mp.*(vp3-(((pang1.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pang2.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat02.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*(pang1.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang2.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pquat01.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*2.0)./(pang1.^2+pang2.^2+pang3.^2)-((pang2.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang1.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pang3.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat03.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*(-pang1.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang2.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat04.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*2.0)./(pang1.^2+pang2.^2+pang3.^2)).*(rp1.*wp3-rp3.*wp1)-(((pang1.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pang2.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat02.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*(-pang1.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang2.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat04.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*2.0)./(pang1.^2+pang2.^2+pang3.^2)+((pang1.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang2.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pquat01.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*(pang2.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang1.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pang3.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat03.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*2.0)./(pang1.^2+pang2.^2+pang3.^2)).*(rp2.*wp3-rp3.*wp2)+(rp1.*wp2-rp2.*wp1).*(((pang1.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pang2.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat02.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).^2.*2.0)./(pang1.^2+pang2.^2+pang3.^2)+((pang2.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang1.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pang3.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat03.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).^2.*2.0)./(pang1.^2+pang2.^2+pang3.^2)-1.0)).*(vf2-vp2+(((pang1.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pang2.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat02.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*(pang1.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang2.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pquat01.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*2.0)./(pang1.^2+pang2.^2+pang3.^2)+((pang2.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang1.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pang3.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat03.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*(-pang1.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang2.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat04.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*2.0)./(pang1.^2+pang2.^2+pang3.^2)).*(rp1.*wp2-rp2.*wp1)+(((pang1.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pang2.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat02.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*(pang2.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang1.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pang3.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat03.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*2.0)./(pang1.^2+pang2.^2+pang3.^2)-((pang1.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang2.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pquat01.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*(-pang1.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang2.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat04.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*2.0)./(pang1.^2+pang2.^2+pang3.^2)).*(rp2.*wp3-rp3.*wp2)+(rp1.*wp3-rp3.*wp1).*(((pang1.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pang2.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat02.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).^2.*2.0)./(pang1.^2+pang2.^2+pang3.^2)+((-pang1.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang2.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat04.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).^2.*2.0)./(pang1.^2+pang2.^2+pang3.^2)-1.0))+mp.*(ap2-(((pang1.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pang2.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat02.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).^2.*2.0)./(pang1.^2+pang2.^2+pang3.^2)+((-pang1.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang2.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat04.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).^2.*2.0)./(pang1.^2+pang2.^2+pang3.^2)-1.0).*(rp1.*wdp3-rp3.*wdp1+wp1.*(rp1.*wp2-rp2.*wp1)-wp3.*(rp2.*wp3-rp3.*wp2))+(((pang1.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pang2.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat02.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*(pang1.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang2.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pquat01.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*2.0)./(pang1.^2+pang2.^2+pang3.^2)+((pang2.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang1.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pang3.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat03.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*(-pang1.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang2.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat04.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*2.0)./(pang1.^2+pang2.^2+pang3.^2)).*(-rp1.*wdp2+rp2.*wdp1+wp1.*(rp1.*wp3-rp3.*wp1)+wp2.*(rp2.*wp3-rp3.*wp2))-(((pang1.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pang2.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat02.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*(pang2.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang1.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pang3.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat03.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*2.0)./(pang1.^2+pang2.^2+pang3.^2)-((pang1.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang2.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pquat01.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*(-pang1.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang2.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat04.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*2.0)./(pang1.^2+pang2.^2+pang3.^2)).*(rp2.*wdp3-rp3.*wdp2+wp2.*(rp1.*wp2-rp2.*wp1)+wp3.*(rp1.*wp3-rp3.*wp1))).*(ftrans3-ptrans3+rp3.*(((pang1.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pang2.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat02.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).^2.*2.0)./(pang1.^2+pang2.^2+pang3.^2)+((pang2.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang1.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pang3.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat03.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).^2.*2.0)./(pang1.^2+pang2.^2+pang3.^2)-1.0)-rp1.*(((pang1.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pang2.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat02.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*(-pang1.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang2.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat04.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*2.0)./(pang1.^2+pang2.^2+pang3.^2)+((pang1.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang2.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pquat01.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*(pang2.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang1.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pang3.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat03.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*2.0)./(pang1.^2+pang2.^2+pang3.^2))+rp2.*(((pang1.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pang2.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat02.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*(pang1.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang2.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pquat01.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*2.0)./(pang1.^2+pang2.^2+pang3.^2)-((pang2.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang1.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pang3.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat03.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*(-pang1.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang2.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat04.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*2.0)./(pang1.^2+pang2.^2+pang3.^2)))-g3.*mp.*(-ftrans2+ptrans2-rp2.*(((pang1.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pang2.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat02.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).^2.*2.0)./(pang1.^2+pang2.^2+pang3.^2)+((-pang1.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang2.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat04.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).^2.*2.0)./(pang1.^2+pang2.^2+pang3.^2)-1.0)+rp1.*(((pang1.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pang2.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat02.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*(pang2.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang1.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pang3.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat03.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*2.0)./(pang1.^2+pang2.^2+pang3.^2)-((pang1.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang2.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pquat01.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*(-pang1.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang2.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat04.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*2.0)./(pang1.^2+pang2.^2+pang3.^2))+rp3.*(((pang1.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pang2.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat02.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*(pang1.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang2.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pquat01.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*2.0)./(pang1.^2+pang2.^2+pang3.^2)+((pang2.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang1.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pang3.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat03.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*(-pang1.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang2.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat04.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*2.0)./(pang1.^2+pang2.^2+pang3.^2)))-g2.*mp.*(ftrans3-ptrans3+rp3.*(((pang1.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pang2.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat02.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).^2.*2.0)./(pang1.^2+pang2.^2+pang3.^2)+((pang2.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang1.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pang3.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat03.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).^2.*2.0)./(pang1.^2+pang2.^2+pang3.^2)-1.0)-rp1.*(((pang1.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pang2.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat02.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*(-pang1.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang2.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat04.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*2.0)./(pang1.^2+pang2.^2+pang3.^2)+((pang1.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang2.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pquat01.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*(pang2.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang1.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pang3.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat03.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*2.0)./(pang1.^2+pang2.^2+pang3.^2))+rp2.*(((pang1.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pang2.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat02.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*(pang1.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang2.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pquat01.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*2.0)./(pang1.^2+pang2.^2+pang3.^2)-((pang2.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang1.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pang3.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat03.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*(-pang1.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang2.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat04.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*2.0)./(pang1.^2+pang2.^2+pang3.^2)))-mf.*((((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(rf1.*wf2-rf2.*wf1)+(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)-((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(rf2.*wf3-rf3.*wf2)+(rf1.*wf3-rf3.*wf1).*(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)-1.0)).*(vf3-(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)-((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(rf1.*wf3-rf3.*wf1)-(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(rf2.*wf3-rf3.*wf2)+(rf1.*wf2-rf2.*wf1).*(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)-1.0))+mf.*(rf3.*(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)-1.0)-rf1.*(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2))+rf2.*(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)-((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2))).*(af2-(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)-1.0).*(rf1.*wdf3-rf3.*wdf1+wf1.*(rf1.*wf2-rf2.*wf1)-wf3.*(rf2.*wf3-rf3.*wf2))+(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(-rf1.*wdf2+rf2.*wdf1+wf1.*(rf1.*wf3-rf3.*wf1)+wf2.*(rf2.*wf3-rf3.*wf2))-(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)-((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(rf2.*wdf3-rf3.*wdf2+wf2.*(rf1.*wf2-rf2.*wf1)+wf3.*(rf1.*wf3-rf3.*wf1)))-mp.*(-vp2+(((pang1.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pang2.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat02.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*(pang1.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang2.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pquat01.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*2.0)./(pang1.^2+pang2.^2+pang3.^2)+((pang2.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang1.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pang3.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat03.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*(-pang1.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang2.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat04.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*2.0)./(pang1.^2+pang2.^2+pang3.^2)).*(rp1.*wp2-rp2.*wp1)+(((pang1.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pang2.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat02.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*(pang2.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang1.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pang3.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat03.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*2.0)./(pang1.^2+pang2.^2+pang3.^2)-((pang1.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang2.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pquat01.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*(-pang1.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang2.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat04.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*2.0)./(pang1.^2+pang2.^2+pang3.^2)).*(rp2.*wp3-rp3.*wp2)+(rp1.*wp3-rp3.*wp1).*(((pang1.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pang2.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat02.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).^2.*2.0)./(pang1.^2+pang2.^2+pang3.^2)+((-pang1.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang2.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat04.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).^2.*2.0)./(pang1.^2+pang2.^2+pang3.^2)-1.0)).*(vf3-vp3+(((pang1.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pang2.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat02.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*(pang1.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang2.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pquat01.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*2.0)./(pang1.^2+pang2.^2+pang3.^2)-((pang2.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang1.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pang3.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat03.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*(-pang1.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang2.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat04.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*2.0)./(pang1.^2+pang2.^2+pang3.^2)).*(rp1.*wp3-rp3.*wp1)+(((pang1.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pang2.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat02.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*(-pang1.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang2.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat04.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*2.0)./(pang1.^2+pang2.^2+pang3.^2)+((pang1.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang2.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pquat01.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*(pang2.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang1.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pang3.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat03.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*2.0)./(pang1.^2+pang2.^2+pang3.^2)).*(rp2.*wp3-rp3.*wp2)-(rp1.*wp2-rp2.*wp1).*(((pang1.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pang2.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat02.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).^2.*2.0)./(pang1.^2+pang2.^2+pang3.^2)+((pang2.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang1.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pang3.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat03.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).^2.*2.0)./(pang1.^2+pang2.^2+pang3.^2)-1.0))-mp.*(-ap3+(((pang1.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pang2.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat02.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).^2.*2.0)./(pang1.^2+pang2.^2+pang3.^2)+((pang2.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang1.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pang3.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat03.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).^2.*2.0)./(pang1.^2+pang2.^2+pang3.^2)-1.0).*(-rp1.*wdp2+rp2.*wdp1+wp1.*(rp1.*wp3-rp3.*wp1)+wp2.*(rp2.*wp3-rp3.*wp2))+(((pang1.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pang2.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat02.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*(pang1.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang2.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pquat01.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*2.0)./(pang1.^2+pang2.^2+pang3.^2)-((pang2.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang1.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pang3.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat03.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*(-pang1.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang2.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat04.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*2.0)./(pang1.^2+pang2.^2+pang3.^2)).*(rp1.*wdp3-rp3.*wdp1+wp1.*(rp1.*wp2-rp2.*wp1)-wp3.*(rp2.*wp3-rp3.*wp2))+(((pang1.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pang2.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat02.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*(-pang1.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang2.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat04.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*2.0)./(pang1.^2+pang2.^2+pang3.^2)+((pang1.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang2.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pquat01.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*(pang2.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang1.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pang3.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat03.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*2.0)./(pang1.^2+pang2.^2+pang3.^2)).*(rp2.*wdp3-rp3.*wdp2+wp2.*(rp1.*wp2-rp2.*wp1)+wp3.*(rp1.*wp3-rp3.*wp1))).*(-ftrans2+ptrans2-rp2.*(((pang1.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pang2.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat02.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).^2.*2.0)./(pang1.^2+pang2.^2+pang3.^2)+((-pang1.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang2.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat04.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).^2.*2.0)./(pang1.^2+pang2.^2+pang3.^2)-1.0)+rp1.*(((pang1.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pang2.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat02.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*(pang2.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang1.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pang3.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat03.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*2.0)./(pang1.^2+pang2.^2+pang3.^2)-((pang1.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang2.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pquat01.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*(-pang1.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang2.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat04.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*2.0)./(pang1.^2+pang2.^2+pang3.^2))+rp3.*(((pang1.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pang2.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat02.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*(pang1.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang2.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pquat01.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*2.0)./(pang1.^2+pang2.^2+pang3.^2)+((pang2.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang1.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pang3.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat03.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*(-pang1.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang2.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat04.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*2.0)./(pang1.^2+pang2.^2+pang3.^2)))-mf.*((((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)-((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(rf1.*wf3-rf3.*wf1)+(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(rf2.*wf3-rf3.*wf2)-(rf1.*wf2-rf2.*wf1).*(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)-1.0)).*(-vf2+(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(rf1.*wf2-rf2.*wf1)+(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)-((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(rf2.*wf3-rf3.*wf2)+(rf1.*wf3-rf3.*wf1).*(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)-1.0))-g2.*mf.*(rf3.*(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)-1.0)-rf1.*(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2))+rf2.*(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)-((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)))-g3.*mf.*(-rf2.*(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)-1.0)+rf1.*(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)-((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2))+rf3.*(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)))-mf.*(-rf2.*(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)-1.0)+rf1.*(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)-((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2))+rf3.*(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2))).*(-af3+(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)-1.0).*(-rf1.*wdf2+rf2.*wdf1+wf1.*(rf1.*wf3-rf3.*wf1)+wf2.*(rf2.*wf3-rf3.*wf2))+(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)-((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(rf1.*wdf3-rf3.*wdf1+wf1.*(rf1.*wf2-rf2.*wf1)-wf3.*(rf2.*wf3-rf3.*wf2))+(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(rf2.*wdf3-rf3.*wdf2+wf2.*(rf1.*wf2-rf2.*wf1)+wf3.*(rf1.*wf3-rf3.*wf1)));ptorque2.*(((pang1.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pang2.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat02.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).^2.*2.0)./(pang1.^2+pang2.^2+pang3.^2)+((-pang1.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang2.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat04.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).^2.*2.0)./(pang1.^2+pang2.^2+pang3.^2)-1.0)+(((pang1.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pang2.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat02.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*(pang1.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang2.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pquat01.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*2.0)./(pang1.^2+pang2.^2+pang3.^2)+((pang2.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang1.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pang3.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat03.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*(-pang1.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang2.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat04.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*2.0)./(pang1.^2+pang2.^2+pang3.^2)).*(Jp3.*wdp3+Pp1.*wdp2+Pp2.*wdp1+wp1.*(Jp2.*wp2+Pp1.*wp3+Pp3.*wp1)-wp2.*(Jp1.*wp1+Pp2.*wp3+Pp3.*wp2))+(((pang1.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pang2.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat02.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*(pang2.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang1.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pang3.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat03.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*2.0)./(pang1.^2+pang2.^2+pang3.^2)-((pang1.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang2.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pquat01.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*(-pang1.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang2.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat04.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*2.0)./(pang1.^2+pang2.^2+pang3.^2)).*(Jp1.*wdp1+Pp2.*wdp3+Pp3.*wdp2+wp2.*(Jp3.*wp3+Pp1.*wp2+Pp2.*wp1)-wp3.*(Jp2.*wp2+Pp1.*wp3+Pp3.*wp1))+(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)-((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(atorque1+Bc3.*(wf2+ws1.*((((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)-((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2))+(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)-1.0)+(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)-((squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)).*(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)-1.0))-ws2.*((((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)-((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)-((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2))+(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2))+(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)-1.0).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)-1.0))-ws3.*((((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)-((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2))+(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)-((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)-1.0)-(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)).*(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)-1.0)))+Bc2.*(wf3+ws1.*(-(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)-((squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2))+(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)-((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)-1.0)+(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)).*(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)-1.0))-ws2.*((((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)-((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2))-(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)-1.0)+(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)-((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)).*(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)-1.0))-ws3.*((((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2))+(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)-((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)-((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2))+(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)-1.0).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)-1.0)))+Bd1.*(wf1-ws1.*((((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)-((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)-((squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2))+(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2))+(((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)-1.0).*(((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)-1.0))+ws2.*((((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)-((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2))+(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)-((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)-1.0)+(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)).*(((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)-1.0))+ws3.*(-(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)-((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2))+(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)-1.0)+(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)-((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)).*(((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)-1.0)))+Kc2.*acos(((((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)-((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)-((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)))./2.0+((((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)))./2.0+((((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)-((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)-((squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)))./2.0+((((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)))./2.0+((((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)-((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)-((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)))./2.0+((((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)))./2.0+((((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)-1.0).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)-1.0))./2.0+((((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)-1.0).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)-1.0))./2.0+((((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)-1.0).*(((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)-1.0))./2.0-1.0./2.0).*((((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)-((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2))-(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)-((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2))-(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)-((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)-1.0)+(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)-1.0)+(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)-((squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)).*(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)-1.0)-(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)).*(((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)-1.0))+Kc3.*acos(((((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)-((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)-((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)))./2.0+((((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)))./2.0+((((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)-((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)-((squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)))./2.0+((((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)))./2.0+((((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)-((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)-((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)))./2.0+((((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)))./2.0+((((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)-1.0).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)-1.0))./2.0+((((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)-1.0).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)-1.0))./2.0+((((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)-1.0).*(((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)-1.0))./2.0-1.0./2.0).*((((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)-((squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2))-(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)-((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2))-(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)-((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)-1.0)+(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)-1.0)+(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)-((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)).*(((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)-1.0)-(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)).*(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)-1.0))+Kd1.*acos(((((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)-((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)-((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)))./2.0+((((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)))./2.0+((((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)-((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)-((squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)))./2.0+((((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)))./2.0+((((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)-((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)-((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)))./2.0+((((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)))./2.0+((((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)-1.0).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)-1.0))./2.0+((((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)-1.0).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)-1.0))./2.0+((((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)-1.0).*(((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)-1.0))./2.0-1.0./2.0).*((((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)-((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2))-(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)-((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2))+(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)-((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)-1.0)+(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)-1.0)-(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)-((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)).*(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)-1.0)-(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)).*(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)-1.0)))+(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(atorque3+Bc2.*(wf1-ws1.*((((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)-((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)-((squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2))+(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2))+(((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)-1.0).*(((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)-1.0))+ws2.*((((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)-((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2))+(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)-((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)-1.0)+(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)).*(((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)-1.0))+ws3.*(-(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)-((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2))+(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)-1.0)+(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)-((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)).*(((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)-1.0)))+Bc1.*(wf2+ws1.*((((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)-((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2))+(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)-1.0)+(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)-((squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)).*(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)-1.0))-ws2.*((((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)-((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)-((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2))+(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2))+(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)-1.0).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)-1.0))-ws3.*((((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)-((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2))+(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)-((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)-1.0)-(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)).*(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)-1.0)))+Bd3.*(wf3+ws1.*(-(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)-((squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2))+(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)-((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)-1.0)+(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)).*(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)-1.0))-ws2.*((((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)-((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2))-(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)-1.0)+(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)-((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)).*(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)-1.0))-ws3.*((((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2))+(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)-((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)-((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2))+(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)-1.0).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)-1.0)))+Kc1.*acos(((((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)-((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)-((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)))./2.0+((((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)))./2.0+((((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)-((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)-((squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)))./2.0+((((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)))./2.0+((((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)-((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)-((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)))./2.0+((((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)))./2.0+((((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)-1.0).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)-1.0))./2.0+((((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)-1.0).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)-1.0))./2.0+((((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)-1.0).*(((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)-1.0))./2.0-1.0./2.0).*((((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)-((squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2))-(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)-((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2))-(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)-((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)-1.0)+(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)-1.0)+(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)-((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)).*(((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)-1.0)-(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)).*(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)-1.0))+Kc2.*acos(((((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)-((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)-((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)))./2.0+((((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)))./2.0+((((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)-((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)-((squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)))./2.0+((((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)))./2.0+((((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)-((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)-((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)))./2.0+((((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)))./2.0+((((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)-1.0).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)-1.0))./2.0+((((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)-1.0).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)-1.0))./2.0+((((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)-1.0).*(((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)-1.0))./2.0-1.0./2.0).*((((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)-((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2))-(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)-((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2))+(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)-((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)-1.0)+(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)-1.0)-(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)-((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)).*(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)-1.0)-(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)).*(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)-1.0))+Kd3.*acos(((((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)-((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)-((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)))./2.0+((((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)))./2.0+((((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)-((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)-((squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)))./2.0+((((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)))./2.0+((((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)-((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)-((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)))./2.0+((((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)))./2.0+((((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)-1.0).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)-1.0))./2.0+((((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)-1.0).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)-1.0))./2.0+((((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)-1.0).*(((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)-1.0))./2.0-1.0./2.0).*((((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)-((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2))-(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)-((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2))-(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)-((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)-1.0)+(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)-1.0)+(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)-((squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)).*(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)-1.0)-(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)).*(((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)-1.0)))+(ftrans1-ptrans1).*(-(pforce1-g1.*mp).*(((pang1.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pang2.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat02.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*(-pang1.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang2.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat04.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*2.0)./(pang1.^2+pang2.^2+pang3.^2)+((pang1.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang2.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pquat01.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*(pang2.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang1.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pang3.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat03.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*2.0)./(pang1.^2+pang2.^2+pang3.^2))+(pforce2-g2.*mp).*(((pang1.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pang2.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat02.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*(pang1.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang2.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pquat01.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*2.0)./(pang1.^2+pang2.^2+pang3.^2)-((pang2.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang1.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pang3.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat03.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*(-pang1.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang2.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat04.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*2.0)./(pang1.^2+pang2.^2+pang3.^2))+(pforce3-g3.*mp).*(((pang1.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pang2.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat02.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).^2.*2.0)./(pang1.^2+pang2.^2+pang3.^2)+((pang2.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang1.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pang3.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat03.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).^2.*2.0)./(pang1.^2+pang2.^2+pang3.^2)-1.0))+(ftrans3-ptrans3).*((pforce2-g2.*mp).*(((pang1.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pang2.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat02.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*(pang2.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang1.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pang3.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat03.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*2.0)./(pang1.^2+pang2.^2+pang3.^2)+((pang1.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang2.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pquat01.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*(-pang1.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang2.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat04.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*2.0)./(pang1.^2+pang2.^2+pang3.^2))+(pforce3-g3.*mp).*(((pang1.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pang2.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat02.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*(-pang1.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang2.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat04.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*2.0)./(pang1.^2+pang2.^2+pang3.^2)-((pang1.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang2.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pquat01.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*(pang2.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang1.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pang3.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat03.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*2.0)./(pang1.^2+pang2.^2+pang3.^2))-(pforce1-g1.*mp).*(((pang2.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang1.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pang3.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat03.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).^2.*2.0)./(pang1.^2+pang2.^2+pang3.^2)+((-pang1.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang2.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat04.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).^2.*2.0)./(pang1.^2+pang2.^2+pang3.^2)-1.0))+(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(Jf3.*wdf3+Pf1.*wdf2+Pf2.*wdf1+wf1.*(Jf2.*wf2+Pf1.*wf3+Pf3.*wf1)-wf2.*(Jf1.*wf1+Pf2.*wf3+Pf3.*wf2))+(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)-((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(Jf1.*wdf1+Pf2.*wdf3+Pf3.*wdf2+wf2.*(Jf3.*wf3+Pf1.*wf2+Pf2.*wf1)-wf3.*(Jf2.*wf2+Pf1.*wf3+Pf3.*wf1))-ptorque1.*(((pang1.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pang2.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat02.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*(pang2.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang1.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pang3.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat03.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*2.0)./(pang1.^2+pang2.^2+pang3.^2)-((pang1.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang2.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pquat01.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*(-pang1.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang2.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat04.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*2.0)./(pang1.^2+pang2.^2+pang3.^2))-ptorque3.*(((pang1.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pang2.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat02.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*(pang1.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang2.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pquat01.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*2.0)./(pang1.^2+pang2.^2+pang3.^2)+((pang2.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang1.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pang3.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat03.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*(-pang1.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang2.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat04.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*2.0)./(pang1.^2+pang2.^2+pang3.^2))-(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)-1.0).*(atorque2+Bc3.*(wf1-ws1.*((((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)-((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)-((squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2))+(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2))+(((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)-1.0).*(((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)-1.0))+ws2.*((((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)-((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2))+(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)-((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)-1.0)+(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)).*(((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)-1.0))+ws3.*(-(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)-((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2))+(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)-1.0)+(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)-((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)).*(((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)-1.0)))+Bc1.*(wf3+ws1.*(-(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)-((squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2))+(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)-((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)-1.0)+(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)).*(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)-1.0))-ws2.*((((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)-((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2))-(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)-1.0)+(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)-((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)).*(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)-1.0))-ws3.*((((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2))+(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)-((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)-((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2))+(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)-1.0).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)-1.0)))+Bd2.*(wf2+ws1.*((((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)-((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2))+(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)-1.0)+(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)-((squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)).*(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)-1.0))-ws2.*((((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)-((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)-((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2))+(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2))+(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)-1.0).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)-1.0))-ws3.*((((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)-((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2))+(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)-((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)-1.0)-(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)).*(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)-1.0)))+Kc1.*acos(((((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)-((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)-((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)))./2.0+((((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)))./2.0+((((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)-((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)-((squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)))./2.0+((((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)))./2.0+((((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)-((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)-((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)))./2.0+((((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)))./2.0+((((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)-1.0).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)-1.0))./2.0+((((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)-1.0).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)-1.0))./2.0+((((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)-1.0).*(((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)-1.0))./2.0-1.0./2.0).*((((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)-((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2))-(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)-((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2))-(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)-((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)-1.0)+(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)-1.0)+(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)-((squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)).*(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)-1.0)-(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)).*(((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)-1.0))+Kc3.*acos(((((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)-((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)-((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)))./2.0+((((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)))./2.0+((((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)-((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)-((squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)))./2.0+((((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)))./2.0+((((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)-((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)-((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)))./2.0+((((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)))./2.0+((((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)-1.0).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)-1.0))./2.0+((((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)-1.0).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)-1.0))./2.0+((((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)-1.0).*(((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)-1.0))./2.0-1.0./2.0).*((((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)-((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2))-(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)-((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2))+(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)-((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)-1.0)+(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)-1.0)-(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)-((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)).*(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)-1.0)-(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)).*(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)-1.0))+Kd2.*acos(((((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)-((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)-((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)))./2.0+((((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)))./2.0+((((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)-((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)-((squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)))./2.0+((((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)))./2.0+((((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)-((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)-((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)))./2.0+((((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)))./2.0+((((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)-1.0).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)-1.0))./2.0+((((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)-1.0).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)-1.0))./2.0+((((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)-1.0).*(((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)-1.0))./2.0-1.0./2.0).*((((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)-((squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2))-(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)-((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2))-(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)-((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)-1.0)+(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)-1.0)+(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)-((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)).*(((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)-1.0)-(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)).*(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)-1.0)))-(((pang1.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pang2.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat02.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).^2.*2.0)./(pang1.^2+pang2.^2+pang3.^2)+((-pang1.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang2.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat04.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).^2.*2.0)./(pang1.^2+pang2.^2+pang3.^2)-1.0).*(Jp2.*wdp2+Pp1.*wdp3+Pp3.*wdp1-wp1.*(Jp3.*wp3+Pp1.*wp2+Pp2.*wp1)+wp3.*(Jp1.*wp1+Pp2.*wp3+Pp3.*wp2))-(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)-1.0).*(Jf2.*wdf2+Pf1.*wdf3+Pf3.*wdf1-wf1.*(Jf3.*wf3+Pf1.*wf2+Pf2.*wf1)+wf3.*(Jf1.*wf1+Pf2.*wf3+Pf3.*wf2))+vf3.*(mf.*(vf1-(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)-((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(rf1.*wf2-rf2.*wf1)+(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(rf1.*wf3-rf3.*wf1)+(rf2.*wf3-rf3.*wf2).*(((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)-1.0))+mp.*(vp1-(((pang1.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pang2.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat02.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*(-pang1.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang2.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat04.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*2.0)./(pang1.^2+pang2.^2+pang3.^2)-((pang1.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang2.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pquat01.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*(pang2.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang1.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pang3.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat03.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*2.0)./(pang1.^2+pang2.^2+pang3.^2)).*(rp1.*wp2-rp2.*wp1)+(((pang1.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pang2.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat02.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*(pang2.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang1.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pang3.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat03.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*2.0)./(pang1.^2+pang2.^2+pang3.^2)+((pang1.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang2.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pquat01.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*(-pang1.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang2.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat04.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*2.0)./(pang1.^2+pang2.^2+pang3.^2)).*(rp1.*wp3-rp3.*wp1)+(rp2.*wp3-rp3.*wp2).*(((pang2.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang1.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pang3.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat03.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).^2.*2.0)./(pang1.^2+pang2.^2+pang3.^2)+((-pang1.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang2.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat04.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).^2.*2.0)./(pang1.^2+pang2.^2+pang3.^2)-1.0)))-vf1.*(mf.*(vf3-(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)-((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(rf1.*wf3-rf3.*wf1)-(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(rf2.*wf3-rf3.*wf2)+(rf1.*wf2-rf2.*wf1).*(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)-1.0))+mp.*(vp3-(((pang1.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pang2.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat02.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*(pang1.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang2.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pquat01.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*2.0)./(pang1.^2+pang2.^2+pang3.^2)-((pang2.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang1.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pang3.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat03.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*(-pang1.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang2.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat04.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*2.0)./(pang1.^2+pang2.^2+pang3.^2)).*(rp1.*wp3-rp3.*wp1)-(((pang1.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pang2.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat02.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*(-pang1.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang2.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat04.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*2.0)./(pang1.^2+pang2.^2+pang3.^2)+((pang1.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang2.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pquat01.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*(pang2.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang1.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pang3.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat03.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*2.0)./(pang1.^2+pang2.^2+pang3.^2)).*(rp2.*wp3-rp3.*wp2)+(rp1.*wp2-rp2.*wp1).*(((pang1.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pang2.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat02.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).^2.*2.0)./(pang1.^2+pang2.^2+pang3.^2)+((pang2.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang1.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pang3.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat03.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).^2.*2.0)./(pang1.^2+pang2.^2+pang3.^2)-1.0)))-mp.*(vp3-(((pang1.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pang2.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat02.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*(pang1.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang2.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pquat01.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*2.0)./(pang1.^2+pang2.^2+pang3.^2)-((pang2.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang1.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pang3.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat03.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*(-pang1.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang2.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat04.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*2.0)./(pang1.^2+pang2.^2+pang3.^2)).*(rp1.*wp3-rp3.*wp1)-(((pang1.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pang2.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat02.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*(-pang1.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang2.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat04.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*2.0)./(pang1.^2+pang2.^2+pang3.^2)+((pang1.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang2.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pquat01.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*(pang2.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang1.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pang3.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat03.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*2.0)./(pang1.^2+pang2.^2+pang3.^2)).*(rp2.*wp3-rp3.*wp2)+(rp1.*wp2-rp2.*wp1).*(((pang1.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pang2.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat02.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).^2.*2.0)./(pang1.^2+pang2.^2+pang3.^2)+((pang2.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang1.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pang3.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat03.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).^2.*2.0)./(pang1.^2+pang2.^2+pang3.^2)-1.0)).*(-vf1+vp1-(((pang1.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pang2.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat02.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*(-pang1.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang2.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat04.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*2.0)./(pang1.^2+pang2.^2+pang3.^2)-((pang1.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang2.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pquat01.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*(pang2.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang1.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pang3.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat03.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*2.0)./(pang1.^2+pang2.^2+pang3.^2)).*(rp1.*wp2-rp2.*wp1)+(((pang1.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pang2.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat02.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*(pang2.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang1.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pang3.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat03.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*2.0)./(pang1.^2+pang2.^2+pang3.^2)+((pang1.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang2.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pquat01.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*(-pang1.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang2.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat04.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*2.0)./(pang1.^2+pang2.^2+pang3.^2)).*(rp1.*wp3-rp3.*wp1)+(rp2.*wp3-rp3.*wp2).*(((pang2.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang1.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pang3.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat03.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).^2.*2.0)./(pang1.^2+pang2.^2+pang3.^2)+((-pang1.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang2.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat04.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).^2.*2.0)./(pang1.^2+pang2.^2+pang3.^2)-1.0))-mp.*(vp1-(((pang1.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pang2.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat02.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*(-pang1.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang2.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat04.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*2.0)./(pang1.^2+pang2.^2+pang3.^2)-((pang1.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang2.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pquat01.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*(pang2.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang1.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pang3.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat03.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*2.0)./(pang1.^2+pang2.^2+pang3.^2)).*(rp1.*wp2-rp2.*wp1)+(((pang1.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pang2.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat02.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*(pang2.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang1.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pang3.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat03.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*2.0)./(pang1.^2+pang2.^2+pang3.^2)+((pang1.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang2.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pquat01.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*(-pang1.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang2.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat04.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*2.0)./(pang1.^2+pang2.^2+pang3.^2)).*(rp1.*wp3-rp3.*wp1)+(rp2.*wp3-rp3.*wp2).*(((pang2.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang1.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pang3.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat03.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).^2.*2.0)./(pang1.^2+pang2.^2+pang3.^2)+((-pang1.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang2.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat04.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).^2.*2.0)./(pang1.^2+pang2.^2+pang3.^2)-1.0)).*(vf3-vp3+(((pang1.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pang2.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat02.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*(pang1.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang2.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pquat01.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*2.0)./(pang1.^2+pang2.^2+pang3.^2)-((pang2.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang1.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pang3.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat03.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*(-pang1.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang2.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat04.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*2.0)./(pang1.^2+pang2.^2+pang3.^2)).*(rp1.*wp3-rp3.*wp1)+(((pang1.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pang2.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat02.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*(-pang1.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang2.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat04.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*2.0)./(pang1.^2+pang2.^2+pang3.^2)+((pang1.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang2.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pquat01.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*(pang2.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang1.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pang3.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat03.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*2.0)./(pang1.^2+pang2.^2+pang3.^2)).*(rp2.*wp3-rp3.*wp2)-(rp1.*wp2-rp2.*wp1).*(((pang1.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pang2.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat02.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).^2.*2.0)./(pang1.^2+pang2.^2+pang3.^2)+((pang2.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang1.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pang3.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat03.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).^2.*2.0)./(pang1.^2+pang2.^2+pang3.^2)-1.0))-mp.*(ap1+(((pang2.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang1.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pang3.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat03.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).^2.*2.0)./(pang1.^2+pang2.^2+pang3.^2)+((-pang1.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang2.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat04.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).^2.*2.0)./(pang1.^2+pang2.^2+pang3.^2)-1.0).*(rp2.*wdp3-rp3.*wdp2+wp2.*(rp1.*wp2-rp2.*wp1)+wp3.*(rp1.*wp3-rp3.*wp1))+(((pang1.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pang2.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat02.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*(-pang1.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang2.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat04.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*2.0)./(pang1.^2+pang2.^2+pang3.^2)-((pang1.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang2.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pquat01.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*(pang2.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang1.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pang3.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat03.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*2.0)./(pang1.^2+pang2.^2+pang3.^2)).*(-rp1.*wdp2+rp2.*wdp1+wp1.*(rp1.*wp3-rp3.*wp1)+wp2.*(rp2.*wp3-rp3.*wp2))+(((pang1.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pang2.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat02.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*(pang2.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang1.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pang3.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat03.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*2.0)./(pang1.^2+pang2.^2+pang3.^2)+((pang1.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang2.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pquat01.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*(-pang1.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang2.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat04.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*2.0)./(pang1.^2+pang2.^2+pang3.^2)).*(rp1.*wdp3-rp3.*wdp1+wp1.*(rp1.*wp2-rp2.*wp1)-wp3.*(rp2.*wp3-rp3.*wp2))).*(ftrans3-ptrans3+rp3.*(((pang1.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pang2.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat02.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).^2.*2.0)./(pang1.^2+pang2.^2+pang3.^2)+((pang2.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang1.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pang3.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat03.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).^2.*2.0)./(pang1.^2+pang2.^2+pang3.^2)-1.0)-rp1.*(((pang1.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pang2.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat02.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*(-pang1.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang2.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat04.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*2.0)./(pang1.^2+pang2.^2+pang3.^2)+((pang1.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang2.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pquat01.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*(pang2.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang1.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pang3.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat03.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*2.0)./(pang1.^2+pang2.^2+pang3.^2))+rp2.*(((pang1.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pang2.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat02.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*(pang1.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang2.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pquat01.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*2.0)./(pang1.^2+pang2.^2+pang3.^2)-((pang2.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang1.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pang3.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat03.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*(-pang1.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang2.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat04.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*2.0)./(pang1.^2+pang2.^2+pang3.^2)))+g3.*mp.*(-ftrans1+ptrans1-rp1.*(((pang2.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang1.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pang3.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat03.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).^2.*2.0)./(pang1.^2+pang2.^2+pang3.^2)+((-pang1.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang2.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat04.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).^2.*2.0)./(pang1.^2+pang2.^2+pang3.^2)-1.0)+rp2.*(((pang1.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pang2.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat02.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*(pang2.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang1.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pang3.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat03.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*2.0)./(pang1.^2+pang2.^2+pang3.^2)+((pang1.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang2.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pquat01.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*(-pang1.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang2.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat04.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*2.0)./(pang1.^2+pang2.^2+pang3.^2))+rp3.*(((pang1.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pang2.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat02.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*(-pang1.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang2.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat04.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*2.0)./(pang1.^2+pang2.^2+pang3.^2)-((pang1.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang2.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pquat01.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*(pang2.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang1.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pang3.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat03.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*2.0)./(pang1.^2+pang2.^2+pang3.^2)))+g1.*mp.*(ftrans3-ptrans3+rp3.*(((pang1.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pang2.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat02.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).^2.*2.0)./(pang1.^2+pang2.^2+pang3.^2)+((pang2.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang1.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pang3.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat03.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).^2.*2.0)./(pang1.^2+pang2.^2+pang3.^2)-1.0)-rp1.*(((pang1.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pang2.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat02.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*(-pang1.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang2.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat04.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*2.0)./(pang1.^2+pang2.^2+pang3.^2)+((pang1.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang2.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pquat01.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*(pang2.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang1.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pang3.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat03.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*2.0)./(pang1.^2+pang2.^2+pang3.^2))+rp2.*(((pang1.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pang2.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat02.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*(pang1.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang2.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pquat01.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*2.0)./(pang1.^2+pang2.^2+pang3.^2)-((pang2.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang1.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pang3.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat03.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*(-pang1.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang2.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat04.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*2.0)./(pang1.^2+pang2.^2+pang3.^2)))-mf.*((((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)-((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(rf1.*wf3-rf3.*wf1)+(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(rf2.*wf3-rf3.*wf2)-(rf1.*wf2-rf2.*wf1).*(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)-1.0)).*(vf1-(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)-((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(rf1.*wf2-rf2.*wf1)+(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(rf1.*wf3-rf3.*wf1)+(rf2.*wf3-rf3.*wf2).*(((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)-1.0))-mf.*(-(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)-((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(rf1.*wf2-rf2.*wf1)+(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(rf1.*wf3-rf3.*wf1)+(rf2.*wf3-rf3.*wf2).*(((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)-1.0)).*(vf3-(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)-((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(rf1.*wf3-rf3.*wf1)-(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(rf2.*wf3-rf3.*wf2)+(rf1.*wf2-rf2.*wf1).*(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)-1.0))-mf.*(rf3.*(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)-1.0)-rf1.*(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2))+rf2.*(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)-((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2))).*(af1+(((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)-1.0).*(rf2.*wdf3-rf3.*wdf2+wf2.*(rf1.*wf2-rf2.*wf1)+wf3.*(rf1.*wf3-rf3.*wf1))+(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)-((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(-rf1.*wdf2+rf2.*wdf1+wf1.*(rf1.*wf3-rf3.*wf1)+wf2.*(rf2.*wf3-rf3.*wf2))+(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(rf1.*wdf3-rf3.*wdf1+wf1.*(rf1.*wf2-rf2.*wf1)-wf3.*(rf2.*wf3-rf3.*wf2)))+mp.*(-ap3+(((pang1.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pang2.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat02.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).^2.*2.0)./(pang1.^2+pang2.^2+pang3.^2)+((pang2.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang1.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pang3.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat03.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).^2.*2.0)./(pang1.^2+pang2.^2+pang3.^2)-1.0).*(-rp1.*wdp2+rp2.*wdp1+wp1.*(rp1.*wp3-rp3.*wp1)+wp2.*(rp2.*wp3-rp3.*wp2))+(((pang1.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pang2.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat02.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*(pang1.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang2.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pquat01.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*2.0)./(pang1.^2+pang2.^2+pang3.^2)-((pang2.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang1.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pang3.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat03.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*(-pang1.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang2.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat04.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*2.0)./(pang1.^2+pang2.^2+pang3.^2)).*(rp1.*wdp3-rp3.*wdp1+wp1.*(rp1.*wp2-rp2.*wp1)-wp3.*(rp2.*wp3-rp3.*wp2))+(((pang1.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pang2.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat02.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*(-pang1.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang2.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat04.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*2.0)./(pang1.^2+pang2.^2+pang3.^2)+((pang1.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang2.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pquat01.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*(pang2.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang1.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pang3.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat03.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*2.0)./(pang1.^2+pang2.^2+pang3.^2)).*(rp2.*wdp3-rp3.*wdp2+wp2.*(rp1.*wp2-rp2.*wp1)+wp3.*(rp1.*wp3-rp3.*wp1))).*(-ftrans1+ptrans1-rp1.*(((pang2.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang1.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pang3.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat03.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).^2.*2.0)./(pang1.^2+pang2.^2+pang3.^2)+((-pang1.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang2.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat04.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).^2.*2.0)./(pang1.^2+pang2.^2+pang3.^2)-1.0)+rp2.*(((pang1.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pang2.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat02.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*(pang2.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang1.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pang3.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat03.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*2.0)./(pang1.^2+pang2.^2+pang3.^2)+((pang1.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang2.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pquat01.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*(-pang1.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang2.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat04.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*2.0)./(pang1.^2+pang2.^2+pang3.^2))+rp3.*(((pang1.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pang2.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat02.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*(-pang1.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang2.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat04.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*2.0)./(pang1.^2+pang2.^2+pang3.^2)-((pang1.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang2.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pquat01.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*(pang2.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang1.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pang3.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat03.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*2.0)./(pang1.^2+pang2.^2+pang3.^2)))+g1.*mf.*(rf3.*(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)-1.0)-rf1.*(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2))+rf2.*(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)-((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)))+g3.*mf.*(-rf1.*(((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)-1.0)+rf2.*(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2))+rf3.*(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)-((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)))+mf.*(-rf1.*(((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)-1.0)+rf2.*(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2))+rf3.*(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)-((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2))).*(-af3+(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)-1.0).*(-rf1.*wdf2+rf2.*wdf1+wf1.*(rf1.*wf3-rf3.*wf1)+wf2.*(rf2.*wf3-rf3.*wf2))+(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)-((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(rf1.*wdf3-rf3.*wdf1+wf1.*(rf1.*wf2-rf2.*wf1)-wf3.*(rf2.*wf3-rf3.*wf2))+(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(rf2.*wdf3-rf3.*wdf2+wf2.*(rf1.*wf2-rf2.*wf1)+wf3.*(rf1.*wf3-rf3.*wf1)));ptorque3.*(((pang1.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pang2.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat02.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).^2.*2.0)./(pang1.^2+pang2.^2+pang3.^2)+((pang2.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang1.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pang3.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat03.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).^2.*2.0)./(pang1.^2+pang2.^2+pang3.^2)-1.0)-(((pang1.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pang2.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat02.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*(pang1.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang2.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pquat01.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*2.0)./(pang1.^2+pang2.^2+pang3.^2)-((pang2.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang1.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pang3.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat03.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*(-pang1.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang2.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat04.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*2.0)./(pang1.^2+pang2.^2+pang3.^2)).*(Jp2.*wdp2+Pp1.*wdp3+Pp3.*wdp1-wp1.*(Jp3.*wp3+Pp1.*wp2+Pp2.*wp1)+wp3.*(Jp1.*wp1+Pp2.*wp3+Pp3.*wp2))+(((pang1.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pang2.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat02.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*(-pang1.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang2.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat04.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*2.0)./(pang1.^2+pang2.^2+pang3.^2)+((pang1.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang2.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pquat01.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*(pang2.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang1.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pang3.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat03.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*2.0)./(pang1.^2+pang2.^2+pang3.^2)).*(Jp1.*wdp1+Pp2.*wdp3+Pp3.*wdp2+wp2.*(Jp3.*wp3+Pp1.*wp2+Pp2.*wp1)-wp3.*(Jp2.*wp2+Pp1.*wp3+Pp3.*wp1))+(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(atorque1+Bc3.*(wf2+ws1.*((((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)-((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2))+(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)-1.0)+(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)-((squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)).*(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)-1.0))-ws2.*((((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)-((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)-((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2))+(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2))+(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)-1.0).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)-1.0))-ws3.*((((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)-((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2))+(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)-((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)-1.0)-(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)).*(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)-1.0)))+Bc2.*(wf3+ws1.*(-(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)-((squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2))+(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)-((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)-1.0)+(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)).*(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)-1.0))-ws2.*((((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)-((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2))-(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)-1.0)+(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)-((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)).*(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)-1.0))-ws3.*((((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2))+(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)-((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)-((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2))+(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)-1.0).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)-1.0)))+Bd1.*(wf1-ws1.*((((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)-((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)-((squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2))+(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2))+(((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)-1.0).*(((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)-1.0))+ws2.*((((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)-((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2))+(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)-((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)-1.0)+(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)).*(((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)-1.0))+ws3.*(-(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)-((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2))+(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)-1.0)+(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)-((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)).*(((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)-1.0)))+Kc2.*acos(((((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)-((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)-((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)))./2.0+((((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)))./2.0+((((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)-((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)-((squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)))./2.0+((((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)))./2.0+((((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)-((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)-((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)))./2.0+((((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)))./2.0+((((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)-1.0).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)-1.0))./2.0+((((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)-1.0).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)-1.0))./2.0+((((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)-1.0).*(((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)-1.0))./2.0-1.0./2.0).*((((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)-((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2))-(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)-((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2))-(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)-((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)-1.0)+(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)-1.0)+(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)-((squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)).*(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)-1.0)-(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)).*(((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)-1.0))+Kc3.*acos(((((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)-((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)-((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)))./2.0+((((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)))./2.0+((((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)-((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)-((squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)))./2.0+((((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)))./2.0+((((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)-((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)-((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)))./2.0+((((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)))./2.0+((((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)-1.0).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)-1.0))./2.0+((((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)-1.0).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)-1.0))./2.0+((((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)-1.0).*(((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)-1.0))./2.0-1.0./2.0).*((((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)-((squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2))-(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)-((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2))-(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)-((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)-1.0)+(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)-1.0)+(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)-((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)).*(((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)-1.0)-(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)).*(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)-1.0))+Kd1.*acos(((((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)-((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)-((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)))./2.0+((((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)))./2.0+((((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)-((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)-((squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)))./2.0+((((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)))./2.0+((((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)-((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)-((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)))./2.0+((((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)))./2.0+((((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)-1.0).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)-1.0))./2.0+((((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)-1.0).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)-1.0))./2.0+((((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)-1.0).*(((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)-1.0))./2.0-1.0./2.0).*((((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)-((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2))-(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)-((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2))+(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)-((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)-1.0)+(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)-1.0)-(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)-((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)).*(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)-1.0)-(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)).*(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)-1.0)))-(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)-((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(atorque2+Bc3.*(wf1-ws1.*((((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)-((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)-((squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2))+(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2))+(((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)-1.0).*(((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)-1.0))+ws2.*((((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)-((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2))+(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)-((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)-1.0)+(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)).*(((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)-1.0))+ws3.*(-(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)-((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2))+(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)-1.0)+(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)-((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)).*(((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)-1.0)))+Bc1.*(wf3+ws1.*(-(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)-((squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2))+(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)-((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)-1.0)+(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)).*(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)-1.0))-ws2.*((((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)-((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2))-(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)-1.0)+(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)-((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)).*(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)-1.0))-ws3.*((((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2))+(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)-((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)-((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2))+(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)-1.0).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)-1.0)))+Bd2.*(wf2+ws1.*((((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)-((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2))+(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)-1.0)+(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)-((squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)).*(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)-1.0))-ws2.*((((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)-((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)-((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2))+(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2))+(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)-1.0).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)-1.0))-ws3.*((((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)-((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2))+(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)-((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)-1.0)-(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)).*(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)-1.0)))+Kc1.*acos(((((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)-((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)-((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)))./2.0+((((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)))./2.0+((((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)-((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)-((squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)))./2.0+((((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)))./2.0+((((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)-((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)-((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)))./2.0+((((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)))./2.0+((((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)-1.0).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)-1.0))./2.0+((((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)-1.0).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)-1.0))./2.0+((((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)-1.0).*(((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)-1.0))./2.0-1.0./2.0).*((((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)-((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2))-(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)-((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2))-(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)-((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)-1.0)+(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)-1.0)+(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)-((squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)).*(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)-1.0)-(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)).*(((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)-1.0))+Kc3.*acos(((((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)-((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)-((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)))./2.0+((((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)))./2.0+((((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)-((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)-((squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)))./2.0+((((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)))./2.0+((((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)-((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)-((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)))./2.0+((((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)))./2.0+((((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)-1.0).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)-1.0))./2.0+((((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)-1.0).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)-1.0))./2.0+((((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)-1.0).*(((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)-1.0))./2.0-1.0./2.0).*((((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)-((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2))-(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)-((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2))+(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)-((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)-1.0)+(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)-1.0)-(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)-((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)).*(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)-1.0)-(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)).*(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)-1.0))+Kd2.*acos(((((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)-((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)-((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)))./2.0+((((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)))./2.0+((((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)-((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)-((squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)))./2.0+((((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)))./2.0+((((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)-((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)-((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)))./2.0+((((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)))./2.0+((((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)-1.0).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)-1.0))./2.0+((((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)-1.0).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)-1.0))./2.0+((((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)-1.0).*(((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)-1.0))./2.0-1.0./2.0).*((((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)-((squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2))-(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)-((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2))-(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)-((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)-1.0)+(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)-1.0)+(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)-((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)).*(((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)-1.0)-(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)).*(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)-1.0)))+(ftrans1-ptrans1).*((pforce1-g1.*mp).*(((pang1.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pang2.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat02.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*(pang2.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang1.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pang3.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat03.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*2.0)./(pang1.^2+pang2.^2+pang3.^2)-((pang1.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang2.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pquat01.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*(-pang1.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang2.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat04.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*2.0)./(pang1.^2+pang2.^2+pang3.^2))+(pforce3-g3.*mp).*(((pang1.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pang2.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat02.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*(pang1.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang2.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pquat01.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*2.0)./(pang1.^2+pang2.^2+pang3.^2)+((pang2.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang1.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pang3.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat03.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*(-pang1.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang2.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat04.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*2.0)./(pang1.^2+pang2.^2+pang3.^2))-(pforce2-g2.*mp).*(((pang1.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pang2.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat02.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).^2.*2.0)./(pang1.^2+pang2.^2+pang3.^2)+((-pang1.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang2.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat04.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).^2.*2.0)./(pang1.^2+pang2.^2+pang3.^2)-1.0))-(ftrans2-ptrans2).*((pforce2-g2.*mp).*(((pang1.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pang2.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat02.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*(pang2.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang1.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pang3.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat03.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*2.0)./(pang1.^2+pang2.^2+pang3.^2)+((pang1.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang2.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pquat01.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*(-pang1.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang2.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat04.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*2.0)./(pang1.^2+pang2.^2+pang3.^2))+(pforce3-g3.*mp).*(((pang1.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pang2.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat02.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*(-pang1.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang2.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat04.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*2.0)./(pang1.^2+pang2.^2+pang3.^2)-((pang1.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang2.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pquat01.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*(pang2.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang1.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pang3.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat03.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*2.0)./(pang1.^2+pang2.^2+pang3.^2))-(pforce1-g1.*mp).*(((pang2.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang1.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pang3.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat03.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).^2.*2.0)./(pang1.^2+pang2.^2+pang3.^2)+((-pang1.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang2.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat04.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).^2.*2.0)./(pang1.^2+pang2.^2+pang3.^2)-1.0))-(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)-((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(Jf2.*wdf2+Pf1.*wdf3+Pf3.*wdf1-wf1.*(Jf3.*wf3+Pf1.*wf2+Pf2.*wf1)+wf3.*(Jf1.*wf1+Pf2.*wf3+Pf3.*wf2))+(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(Jf1.*wdf1+Pf2.*wdf3+Pf3.*wdf2+wf2.*(Jf3.*wf3+Pf1.*wf2+Pf2.*wf1)-wf3.*(Jf2.*wf2+Pf1.*wf3+Pf3.*wf1))-ptorque1.*(((pang1.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pang2.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat02.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*(-pang1.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang2.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat04.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*2.0)./(pang1.^2+pang2.^2+pang3.^2)+((pang1.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang2.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pquat01.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*(pang2.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang1.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pang3.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat03.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*2.0)./(pang1.^2+pang2.^2+pang3.^2))+ptorque2.*(((pang1.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pang2.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat02.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*(pang1.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang2.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pquat01.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*2.0)./(pang1.^2+pang2.^2+pang3.^2)-((pang2.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang1.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pang3.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat03.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*(-pang1.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang2.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat04.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*2.0)./(pang1.^2+pang2.^2+pang3.^2))-vf1.*(mf.*(-vf2+(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(rf1.*wf2-rf2.*wf1)+(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)-((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(rf2.*wf3-rf3.*wf2)+(rf1.*wf3-rf3.*wf1).*(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)-1.0))+mp.*(-vp2+(((pang1.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pang2.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat02.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*(pang1.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang2.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pquat01.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*2.0)./(pang1.^2+pang2.^2+pang3.^2)+((pang2.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang1.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pang3.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat03.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*(-pang1.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang2.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat04.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*2.0)./(pang1.^2+pang2.^2+pang3.^2)).*(rp1.*wp2-rp2.*wp1)+(((pang1.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pang2.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat02.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*(pang2.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang1.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pang3.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat03.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*2.0)./(pang1.^2+pang2.^2+pang3.^2)-((pang1.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang2.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pquat01.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*(-pang1.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang2.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat04.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*2.0)./(pang1.^2+pang2.^2+pang3.^2)).*(rp2.*wp3-rp3.*wp2)+(rp1.*wp3-rp3.*wp1).*(((pang1.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pang2.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat02.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).^2.*2.0)./(pang1.^2+pang2.^2+pang3.^2)+((-pang1.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang2.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat04.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).^2.*2.0)./(pang1.^2+pang2.^2+pang3.^2)-1.0)))-(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)-1.0).*(atorque3+Bc2.*(wf1-ws1.*((((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)-((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)-((squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2))+(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2))+(((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)-1.0).*(((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)-1.0))+ws2.*((((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)-((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2))+(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)-((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)-1.0)+(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)).*(((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)-1.0))+ws3.*(-(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)-((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2))+(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)-1.0)+(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)-((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)).*(((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)-1.0)))+Bc1.*(wf2+ws1.*((((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)-((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2))+(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)-1.0)+(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)-((squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)).*(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)-1.0))-ws2.*((((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)-((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)-((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2))+(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2))+(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)-1.0).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)-1.0))-ws3.*((((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)-((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2))+(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)-((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)-1.0)-(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)).*(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)-1.0)))+Bd3.*(wf3+ws1.*(-(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)-((squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2))+(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)-((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)-1.0)+(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)).*(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)-1.0))-ws2.*((((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)-((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2))-(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)-1.0)+(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)-((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)).*(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)-1.0))-ws3.*((((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2))+(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)-((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)-((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2))+(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)-1.0).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)-1.0)))+Kc1.*acos(((((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)-((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)-((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)))./2.0+((((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)))./2.0+((((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)-((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)-((squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)))./2.0+((((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)))./2.0+((((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)-((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)-((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)))./2.0+((((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)))./2.0+((((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)-1.0).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)-1.0))./2.0+((((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)-1.0).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)-1.0))./2.0+((((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)-1.0).*(((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)-1.0))./2.0-1.0./2.0).*((((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)-((squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2))-(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)-((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2))-(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)-((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)-1.0)+(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)-1.0)+(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)-((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)).*(((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)-1.0)-(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)).*(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)-1.0))+Kc2.*acos(((((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)-((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)-((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)))./2.0+((((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)))./2.0+((((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)-((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)-((squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)))./2.0+((((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)))./2.0+((((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)-((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)-((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)))./2.0+((((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)))./2.0+((((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)-1.0).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)-1.0))./2.0+((((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)-1.0).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)-1.0))./2.0+((((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)-1.0).*(((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)-1.0))./2.0-1.0./2.0).*((((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)-((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2))-(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)-((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2))+(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)-((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)-1.0)+(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)-1.0)-(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)-((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)).*(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)-1.0)-(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)).*(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)-1.0))+Kd3.*acos(((((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)-((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)-((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)))./2.0+((((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)))./2.0+((((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)-((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)-((squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)))./2.0+((((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)))./2.0+((((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)-((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)-((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)))./2.0+((((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)))./2.0+((((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)-1.0).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)-1.0))./2.0+((((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)-1.0).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)-1.0))./2.0+((((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)-1.0).*(((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)-1.0))./2.0-1.0./2.0).*((((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)-((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2))-(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)-((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2))-(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)-((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)-1.0)+(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(((squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).^2.*2.0)./(sang1.^2+sang2.^2+sang3.^2)-1.0)+(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)-((squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)).*(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)-1.0)-(((squat02.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang2.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(squat03.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang2.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang1.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)-sang3.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)+((squat04.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)-sang1.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat01.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*(-squat01.*cos(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0).*sqrt(sang1.^2+sang2.^2+sang3.^2)+sang1.*squat02.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang2.*squat03.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)+sang3.*squat04.*sin(sqrt(sang1.^2+sang2.^2+sang3.^2)./2.0)).*2.0)./(sang1.^2+sang2.^2+sang3.^2)).*(((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)-1.0)))-(((pang1.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pang2.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat02.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).^2.*2.0)./(pang1.^2+pang2.^2+pang3.^2)+((pang2.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang1.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pang3.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat03.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).^2.*2.0)./(pang1.^2+pang2.^2+pang3.^2)-1.0).*(Jp3.*wdp3+Pp1.*wdp2+Pp2.*wdp1+wp1.*(Jp2.*wp2+Pp1.*wp3+Pp3.*wp1)-wp2.*(Jp1.*wp1+Pp2.*wp3+Pp3.*wp2))-(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)-1.0).*(Jf3.*wdf3+Pf1.*wdf2+Pf2.*wdf1+wf1.*(Jf2.*wf2+Pf1.*wf3+Pf3.*wf1)-wf2.*(Jf1.*wf1+Pf2.*wf3+Pf3.*wf2))-vf2.*(mf.*(vf1-(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)-((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(rf1.*wf2-rf2.*wf1)+(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(rf1.*wf3-rf3.*wf1)+(rf2.*wf3-rf3.*wf2).*(((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)-1.0))+mp.*(vp1-(((pang1.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pang2.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat02.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*(-pang1.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang2.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat04.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*2.0)./(pang1.^2+pang2.^2+pang3.^2)-((pang1.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang2.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pquat01.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*(pang2.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang1.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pang3.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat03.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*2.0)./(pang1.^2+pang2.^2+pang3.^2)).*(rp1.*wp2-rp2.*wp1)+(((pang1.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pang2.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat02.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*(pang2.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang1.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pang3.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat03.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*2.0)./(pang1.^2+pang2.^2+pang3.^2)+((pang1.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang2.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pquat01.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*(-pang1.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang2.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat04.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*2.0)./(pang1.^2+pang2.^2+pang3.^2)).*(rp1.*wp3-rp3.*wp1)+(rp2.*wp3-rp3.*wp2).*(((pang2.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang1.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pang3.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat03.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).^2.*2.0)./(pang1.^2+pang2.^2+pang3.^2)+((-pang1.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang2.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat04.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).^2.*2.0)./(pang1.^2+pang2.^2+pang3.^2)-1.0)))+mp.*(vp1-(((pang1.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pang2.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat02.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*(-pang1.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang2.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat04.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*2.0)./(pang1.^2+pang2.^2+pang3.^2)-((pang1.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang2.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pquat01.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*(pang2.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang1.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pang3.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat03.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*2.0)./(pang1.^2+pang2.^2+pang3.^2)).*(rp1.*wp2-rp2.*wp1)+(((pang1.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pang2.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat02.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*(pang2.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang1.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pang3.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat03.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*2.0)./(pang1.^2+pang2.^2+pang3.^2)+((pang1.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang2.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pquat01.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*(-pang1.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang2.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat04.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*2.0)./(pang1.^2+pang2.^2+pang3.^2)).*(rp1.*wp3-rp3.*wp1)+(rp2.*wp3-rp3.*wp2).*(((pang2.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang1.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pang3.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat03.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).^2.*2.0)./(pang1.^2+pang2.^2+pang3.^2)+((-pang1.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang2.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat04.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).^2.*2.0)./(pang1.^2+pang2.^2+pang3.^2)-1.0)).*(vf2-vp2+(((pang1.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pang2.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat02.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*(pang1.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang2.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pquat01.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*2.0)./(pang1.^2+pang2.^2+pang3.^2)+((pang2.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang1.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pang3.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat03.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*(-pang1.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang2.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat04.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*2.0)./(pang1.^2+pang2.^2+pang3.^2)).*(rp1.*wp2-rp2.*wp1)+(((pang1.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pang2.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat02.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*(pang2.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang1.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pang3.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat03.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*2.0)./(pang1.^2+pang2.^2+pang3.^2)-((pang1.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang2.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pquat01.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*(-pang1.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang2.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat04.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*2.0)./(pang1.^2+pang2.^2+pang3.^2)).*(rp2.*wp3-rp3.*wp2)+(rp1.*wp3-rp3.*wp1).*(((pang1.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pang2.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat02.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).^2.*2.0)./(pang1.^2+pang2.^2+pang3.^2)+((-pang1.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang2.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat04.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).^2.*2.0)./(pang1.^2+pang2.^2+pang3.^2)-1.0))-mp.*(ap1+(((pang2.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang1.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pang3.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat03.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).^2.*2.0)./(pang1.^2+pang2.^2+pang3.^2)+((-pang1.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang2.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat04.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).^2.*2.0)./(pang1.^2+pang2.^2+pang3.^2)-1.0).*(rp2.*wdp3-rp3.*wdp2+wp2.*(rp1.*wp2-rp2.*wp1)+wp3.*(rp1.*wp3-rp3.*wp1))+(((pang1.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pang2.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat02.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*(-pang1.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang2.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat04.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*2.0)./(pang1.^2+pang2.^2+pang3.^2)-((pang1.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang2.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pquat01.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*(pang2.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang1.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pang3.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat03.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*2.0)./(pang1.^2+pang2.^2+pang3.^2)).*(-rp1.*wdp2+rp2.*wdp1+wp1.*(rp1.*wp3-rp3.*wp1)+wp2.*(rp2.*wp3-rp3.*wp2))+(((pang1.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pang2.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat02.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*(pang2.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang1.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pang3.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat03.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*2.0)./(pang1.^2+pang2.^2+pang3.^2)+((pang1.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang2.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pquat01.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*(-pang1.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang2.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat04.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*2.0)./(pang1.^2+pang2.^2+pang3.^2)).*(rp1.*wdp3-rp3.*wdp1+wp1.*(rp1.*wp2-rp2.*wp1)-wp3.*(rp2.*wp3-rp3.*wp2))).*(-ftrans2+ptrans2-rp2.*(((pang1.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pang2.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat02.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).^2.*2.0)./(pang1.^2+pang2.^2+pang3.^2)+((-pang1.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang2.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat04.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).^2.*2.0)./(pang1.^2+pang2.^2+pang3.^2)-1.0)+rp1.*(((pang1.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pang2.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat02.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*(pang2.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang1.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pang3.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat03.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*2.0)./(pang1.^2+pang2.^2+pang3.^2)-((pang1.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang2.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pquat01.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*(-pang1.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang2.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat04.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*2.0)./(pang1.^2+pang2.^2+pang3.^2))+rp3.*(((pang1.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pang2.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat02.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*(pang1.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang2.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pquat01.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*2.0)./(pang1.^2+pang2.^2+pang3.^2)+((pang2.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang1.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pang3.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat03.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*(-pang1.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang2.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat04.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*2.0)./(pang1.^2+pang2.^2+pang3.^2)))+mp.*(ap2-(((pang1.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pang2.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat02.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).^2.*2.0)./(pang1.^2+pang2.^2+pang3.^2)+((-pang1.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang2.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat04.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).^2.*2.0)./(pang1.^2+pang2.^2+pang3.^2)-1.0).*(rp1.*wdp3-rp3.*wdp1+wp1.*(rp1.*wp2-rp2.*wp1)-wp3.*(rp2.*wp3-rp3.*wp2))+(((pang1.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pang2.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat02.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*(pang1.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang2.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pquat01.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*2.0)./(pang1.^2+pang2.^2+pang3.^2)+((pang2.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang1.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pang3.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat03.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*(-pang1.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang2.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat04.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*2.0)./(pang1.^2+pang2.^2+pang3.^2)).*(-rp1.*wdp2+rp2.*wdp1+wp1.*(rp1.*wp3-rp3.*wp1)+wp2.*(rp2.*wp3-rp3.*wp2))-(((pang1.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pang2.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat02.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*(pang2.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang1.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pang3.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat03.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*2.0)./(pang1.^2+pang2.^2+pang3.^2)-((pang1.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang2.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pquat01.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*(-pang1.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang2.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat04.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*2.0)./(pang1.^2+pang2.^2+pang3.^2)).*(rp2.*wdp3-rp3.*wdp2+wp2.*(rp1.*wp2-rp2.*wp1)+wp3.*(rp1.*wp3-rp3.*wp1))).*(-ftrans1+ptrans1-rp1.*(((pang2.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang1.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pang3.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat03.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).^2.*2.0)./(pang1.^2+pang2.^2+pang3.^2)+((-pang1.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang2.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat04.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).^2.*2.0)./(pang1.^2+pang2.^2+pang3.^2)-1.0)+rp2.*(((pang1.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pang2.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat02.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*(pang2.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang1.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pang3.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat03.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*2.0)./(pang1.^2+pang2.^2+pang3.^2)+((pang1.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang2.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pquat01.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*(-pang1.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang2.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat04.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*2.0)./(pang1.^2+pang2.^2+pang3.^2))+rp3.*(((pang1.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pang2.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat02.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*(-pang1.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang2.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat04.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*2.0)./(pang1.^2+pang2.^2+pang3.^2)-((pang1.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang2.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pquat01.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*(pang2.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang1.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pang3.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat03.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*2.0)./(pang1.^2+pang2.^2+pang3.^2)))-g2.*mp.*(-ftrans1+ptrans1-rp1.*(((pang2.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang1.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pang3.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat03.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).^2.*2.0)./(pang1.^2+pang2.^2+pang3.^2)+((-pang1.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang2.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat04.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).^2.*2.0)./(pang1.^2+pang2.^2+pang3.^2)-1.0)+rp2.*(((pang1.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pang2.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat02.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*(pang2.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang1.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pang3.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat03.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*2.0)./(pang1.^2+pang2.^2+pang3.^2)+((pang1.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang2.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pquat01.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*(-pang1.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang2.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat04.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*2.0)./(pang1.^2+pang2.^2+pang3.^2))+rp3.*(((pang1.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pang2.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat02.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*(-pang1.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang2.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat04.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*2.0)./(pang1.^2+pang2.^2+pang3.^2)-((pang1.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang2.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pquat01.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*(pang2.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang1.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pang3.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat03.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*2.0)./(pang1.^2+pang2.^2+pang3.^2)))+g1.*mp.*(-ftrans2+ptrans2-rp2.*(((pang1.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pang2.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat02.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).^2.*2.0)./(pang1.^2+pang2.^2+pang3.^2)+((-pang1.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang2.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat04.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).^2.*2.0)./(pang1.^2+pang2.^2+pang3.^2)-1.0)+rp1.*(((pang1.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pang2.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat02.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*(pang2.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang1.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pang3.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat03.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*2.0)./(pang1.^2+pang2.^2+pang3.^2)-((pang1.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang2.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pquat01.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*(-pang1.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang2.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat04.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*2.0)./(pang1.^2+pang2.^2+pang3.^2))+rp3.*(((pang1.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pang2.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat02.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*(pang1.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang2.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pquat01.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*2.0)./(pang1.^2+pang2.^2+pang3.^2)+((pang2.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang1.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pang3.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat03.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*(-pang1.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang2.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat04.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*2.0)./(pang1.^2+pang2.^2+pang3.^2)))+mf.*((((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(rf1.*wf2-rf2.*wf1)+(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)-((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(rf2.*wf3-rf3.*wf2)+(rf1.*wf3-rf3.*wf1).*(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)-1.0)).*(vf1-(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)-((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(rf1.*wf2-rf2.*wf1)+(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(rf1.*wf3-rf3.*wf1)+(rf2.*wf3-rf3.*wf2).*(((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)-1.0))-mf.*(-rf2.*(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)-1.0)+rf1.*(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)-((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2))+rf3.*(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2))).*(af1+(((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)-1.0).*(rf2.*wdf3-rf3.*wdf2+wf2.*(rf1.*wf2-rf2.*wf1)+wf3.*(rf1.*wf3-rf3.*wf1))+(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)-((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(-rf1.*wdf2+rf2.*wdf1+wf1.*(rf1.*wf3-rf3.*wf1)+wf2.*(rf2.*wf3-rf3.*wf2))+(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(rf1.*wdf3-rf3.*wdf1+wf1.*(rf1.*wf2-rf2.*wf1)-wf3.*(rf2.*wf3-rf3.*wf2)))+mf.*(-rf1.*(((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)-1.0)+rf2.*(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2))+rf3.*(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)-((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2))).*(af2-(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)-1.0).*(rf1.*wdf3-rf3.*wdf1+wf1.*(rf1.*wf2-rf2.*wf1)-wf3.*(rf2.*wf3-rf3.*wf2))+(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(-rf1.*wdf2+rf2.*wdf1+wf1.*(rf1.*wf3-rf3.*wf1)+wf2.*(rf2.*wf3-rf3.*wf2))-(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)-((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(rf2.*wdf3-rf3.*wdf2+wf2.*(rf1.*wf2-rf2.*wf1)+wf3.*(rf1.*wf3-rf3.*wf1)))-mp.*(-vp2+(((pang1.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pang2.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat02.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*(pang1.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang2.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pquat01.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*2.0)./(pang1.^2+pang2.^2+pang3.^2)+((pang2.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang1.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pang3.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat03.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*(-pang1.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang2.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat04.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*2.0)./(pang1.^2+pang2.^2+pang3.^2)).*(rp1.*wp2-rp2.*wp1)+(((pang1.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pang2.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat02.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*(pang2.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang1.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pang3.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat03.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*2.0)./(pang1.^2+pang2.^2+pang3.^2)-((pang1.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang2.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pquat01.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*(-pang1.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang2.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat04.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*2.0)./(pang1.^2+pang2.^2+pang3.^2)).*(rp2.*wp3-rp3.*wp2)+(rp1.*wp3-rp3.*wp1).*(((pang1.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pang2.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat02.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).^2.*2.0)./(pang1.^2+pang2.^2+pang3.^2)+((-pang1.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang2.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat04.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).^2.*2.0)./(pang1.^2+pang2.^2+pang3.^2)-1.0)).*(-vf1+vp1-(((pang1.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pang2.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat02.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*(-pang1.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang2.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat04.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*2.0)./(pang1.^2+pang2.^2+pang3.^2)-((pang1.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang2.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pquat01.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*(pang2.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang1.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pang3.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat03.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*2.0)./(pang1.^2+pang2.^2+pang3.^2)).*(rp1.*wp2-rp2.*wp1)+(((pang1.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pang2.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat02.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*(pang2.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang1.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pang3.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat03.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*2.0)./(pang1.^2+pang2.^2+pang3.^2)+((pang1.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang2.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pquat01.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*(-pang1.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang2.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat04.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).*2.0)./(pang1.^2+pang2.^2+pang3.^2)).*(rp1.*wp3-rp3.*wp1)+(rp2.*wp3-rp3.*wp2).*(((pang2.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang1.*pquat04.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)-pang3.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat03.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).^2.*2.0)./(pang1.^2+pang2.^2+pang3.^2)+((-pang1.*pquat03.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang2.*pquat02.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pang3.*pquat01.*sin(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0)+pquat04.*cos(sqrt(pang1.^2+pang2.^2+pang3.^2)./2.0).*sqrt(pang1.^2+pang2.^2+pang3.^2)).^2.*2.0)./(pang1.^2+pang2.^2+pang3.^2)-1.0))-mf.*(-(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)-((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(rf1.*wf2-rf2.*wf1)+(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(rf1.*wf3-rf3.*wf1)+(rf2.*wf3-rf3.*wf2).*(((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)-1.0)).*(-vf2+(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(rf1.*wf2-rf2.*wf1)+(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)-((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)).*(rf2.*wf3-rf3.*wf2)+(rf1.*wf3-rf3.*wf1).*(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)-1.0))+g1.*mf.*(-rf2.*(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)-1.0)+rf1.*(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)-((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2))+rf3.*(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)))-g2.*mf.*(-rf1.*(((fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).^2.*2.0)./(fang1.^2+fang2.^2+fang3.^2)-1.0)+rf2.*(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)+((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2))+rf3.*(((fang1.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang2.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat02.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(-fang1.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat04.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)-((fang1.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang2.*fquat03.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang3.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fquat01.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*(fang2.*fquat01.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fang1.*fquat04.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)-fang3.*fquat02.*sin(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0)+fquat03.*cos(sqrt(fang1.^2+fang2.^2+fang3.^2)./2.0).*sqrt(fang1.^2+fang2.^2+fang3.^2)).*2.0)./(fang1.^2+fang2.^2+fang3.^2)))];
